!function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(n){return t[n]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){var i;i=function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=5)}([function(t,n,e){"use strict";t.exports=function(t,n){var e,i,o;for(e=1;e<arguments.length;e++)for(o in i=arguments[e])i.hasOwnProperty(o)&&(t[o]=i[o]);return t}},function(t,n,e){"use strict";var i=e(0);t.exports={build:function(t,n){var e,o,r,s=n.plugins;for(e=0,o=s.length;e<o;e++)(r=s[e]).methods&&i(t,r.methods),r.properties&&Object.defineProperties(t,r.properties)},hook:function(t,n,e){var i,o,r,s,a=t.config.plugins,c=[t.context];for(e&&(c=c.concat(e)),i=0,o=a.length;i<o;i++)s=a[i],(r=a[i][n])&&r.apply(s,c)}}},function(t,n,e){"use strict";function i(t){if(0===t.length)return t;var n,e,i=t.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return t;for(e=i[0].toLowerCase(),n=1;n<i.length;n++)e=e+i[n].charAt(0).toUpperCase()+i[n].substring(1).toLowerCase();return e}i.prepended=function(t,n){return t+(n=i(n))[0].toUpperCase()+n.substring(1)},t.exports=i},function(t,n,e){"use strict";var i=e(0),o=e(2);function r(t,n){t=t||{},this.options=t,this.defaults=n.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(t.init),this.data=this.configureData(t.data),this.methods=this.configureMethods(t.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(t.transitions||[]),this.plugins=this.configurePlugins(t.plugins,n.plugin)}i(r.prototype,{addState:function(t){this.map[t]||(this.states.push(t),this.addStateLifecycleNames(t),this.map[t]={})},addStateLifecycleNames:function(t){this.lifecycle.onEnter[t]=o.prepended("onEnter",t),this.lifecycle.onLeave[t]=o.prepended("onLeave",t),this.lifecycle.on[t]=o.prepended("on",t)},addTransition:function(t){this.transitions.indexOf(t)<0&&(this.transitions.push(t),this.addTransitionLifecycleNames(t))},addTransitionLifecycleNames:function(t){this.lifecycle.onBefore[t]=o.prepended("onBefore",t),this.lifecycle.onAfter[t]=o.prepended("onAfter",t),this.lifecycle.on[t]=o.prepended("on",t)},mapTransition:function(t){var n=t.name,e=t.from,i=t.to;return this.addState(e),"function"!=typeof i&&this.addState(i),this.addTransition(n),this.map[e][n]=t,t},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(t){return"string"==typeof t?this.mapTransition(i({},this.defaults.init,{to:t,active:!0})):"object"==typeof t?this.mapTransition(i({},this.defaults.init,t,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(t){return"function"==typeof t?t:"object"==typeof t?function(){return t}:function(){return{}}},configureMethods:function(t){return t||{}},configurePlugins:function(t,n){var e,i,o;for(e=0,i=(t=t||[]).length;e<i;e++)"function"==typeof(o=t[e])&&(t[e]=o=o()),o.configure&&o.configure(this);return t},configureTransitions:function(t){var n,e,i,o,r,s=this.defaults.wildcard;for(e=0;e<t.length;e++)for(i=t[e],o=Array.isArray(i.from)?i.from:[i.from||s],r=i.to||s,n=0;n<o.length;n++)this.mapTransition({name:i.name,from:o[n],to:r})},transitionFor:function(t,n){var e=this.defaults.wildcard;return this.map[t][n]||this.map[e][n]},transitionsFor:function(t){var n=this.defaults.wildcard;return Object.keys(this.map[t]).concat(Object.keys(this.map[n]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),t.exports=r},function(t,n,e){var i=e(0),o=e(6),r=e(1),s=[null,[]];function a(t,n){this.context=t,this.config=n,this.state=n.init.from,this.observers=[t]}i(a.prototype,{init:function(t){if(i(this.context,this.config.data.apply(this.context,t)),r.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(t){return Array.isArray(t)?t.indexOf(this.state)>=0:this.state===t},isPending:function(){return this.pending},can:function(t){return!this.isPending()&&!!this.seek(t)},cannot:function(t){return!this.can(t)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(t,n){var e=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,t),o=i&&i.to;return"function"==typeof o?o.apply(this.context,n):o===e?this.state:o},fire:function(t,n){return this.transit(t,this.state,this.seek(t,n),n)},transit:function(t,n,e,i){var o=this.config.lifecycle,r=this.config.options.observeUnchangedState||n!==e;return e?this.isPending()?this.context.onPendingTransition(t,n,e):(this.config.addState(e),this.beginTransit(),i.unshift({transition:t,from:n,to:e,fsm:this.context}),this.observeEvents([this.observersForEvent(o.onBefore.transition),this.observersForEvent(o.onBefore[t]),r?this.observersForEvent(o.onLeave.state):s,r?this.observersForEvent(o.onLeave[n]):s,this.observersForEvent(o.on.transition),r?["doTransit",[this]]:s,r?this.observersForEvent(o.onEnter.state):s,r?this.observersForEvent(o.onEnter[e]):s,r?this.observersForEvent(o.on[e]):s,this.observersForEvent(o.onAfter.transition),this.observersForEvent(o.onAfter[t]),this.observersForEvent(o.on[t])],i)):this.context.onInvalidTransition(t,n,e)},beginTransit:function(){this.pending=!0},endTransit:function(t){return this.pending=!1,t},failTransit:function(t){throw this.pending=!1,t},doTransit:function(t){this.state=t.to},observe:function(t){if(2===t.length){var n={};n[t[0]]=t[1],this.observers.push(n)}else this.observers.push(t[0])},observersForEvent:function(t){for(var n,e=0,i=this.observers.length,o=[];e<i;e++)(n=this.observers[e])[t]&&o.push(n);return[t,o,!0]},observeEvents:function(t,n,e,i){if(0===t.length)return this.endTransit(void 0===i||i);var o=t[0][0],s=t[0][1],a=t[0][2];if(n[0].event=o,o&&a&&o!==e&&r.hook(this,"lifecycle",n),0===s.length)return t.shift(),this.observeEvents(t,n,o,i);var c=s.shift(),f=c[o].apply(c,n);return f&&"function"==typeof f.then?f.then(this.observeEvents.bind(this,t,n,o)).catch(this.failTransit.bind(this)):!1===f?this.endTransit(!1):this.observeEvents(t,n,o,f)},onInvalidTransition:function(t,n,e){throw new o("transition is invalid in current state",t,n,e,this.state)},onPendingTransition:function(t,n,e){throw new o("transition is invalid while previous transition is still in progress",t,n,e,this.state)}}),t.exports=a},function(t,n,e){"use strict";var i=e(0),o=e(2),r=e(1),s=e(3),a=e(4),c={is:function(t){return this._fsm.is(t)},can:function(t){return this._fsm.can(t)},cannot:function(t){return this._fsm.cannot(t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(t,n,e){return this._fsm.onInvalidTransition(t,n,e)},onPendingTransition:function(t,n,e){return this._fsm.onPendingTransition(t,n,e)}},f={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(t){throw Error("use transitions to change state")}}};function u(t){return l(this||{},t)}function l(t,n){return h(t,new s(n,u)),t._fsm(),t}function h(t,n){if("object"!=typeof t||Array.isArray(t))throw Error("StateMachine can only be applied to objects");r.build(t,n),Object.defineProperties(t,f),i(t,c),i(t,n.methods),n.allTransitions().forEach((function(n){t[o(n)]=function(){return this._fsm.fire(n,[].slice.call(arguments))}})),t._fsm=function(){this._fsm=new a(this,n),this._fsm.init(arguments)}}u.version="3.0.1",u.factory=function(){var t,n;"function"==typeof arguments[0]?(t=arguments[0],n=arguments[1]||{}):(t=function(){this._fsm.apply(this,arguments)},n=arguments[0]||{});var e=new s(n,u);return h(t.prototype,e),t.prototype._fsm.config=e,t},u.apply=l,u.defaults={wildcard:"*",init:{name:"init",from:"none"}},t.exports=u},function(t,n,e){"use strict";t.exports=function(t,n,e,i,o){this.message=t,this.transition=n,this.from=e,this.to=i,this.current=o}}])},t.exports=i()},function(t,n,e){"use strict";e.r(n);var i={};!function t(n,e,i,o){var r=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL);function s(){}function a(t){var i=e.exports.Promise,o=void 0!==i?i:n.Promise;return"function"==typeof o?new o(t):(t(s,s),null)}var c,f,u,l,h,d,p,m,g=(u=Math.floor(1e3/60),l={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(c=function(t){var n=Math.random();return l[n]=requestAnimationFrame((function e(i){h===i||h+u-1<i?(h=i,delete l[n],t()):l[n]=requestAnimationFrame(e)})),n},f=function(t){l[t]&&cancelAnimationFrame(l[t])}):(c=function(t){return setTimeout(t,u)},f=function(t){return clearTimeout(t)}),{frame:c,cancel:f}),v=(m={},function(){if(d)return d;if(!i&&r){var n=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{d=new Worker(URL.createObjectURL(new Blob([n])))}catch(t){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("🎊 Count not load worker",t),null}!function(t){function n(n,e){t.postMessage({options:n||{},callback:e})}t.init=function(n){var e=n.transferControlToOffscreen();t.postMessage({canvas:e},[e])},t.fire=function(e,i,o){if(p)return n(e,null),p;var r=Math.random().toString(36).slice(2);return p=a((function(i){function s(n){n.data.callback===r&&(delete m[r],t.removeEventListener("message",s),p=null,o(),i())}t.addEventListener("message",s),n(e,r),m[r]=s.bind(null,{data:{callback:r}})}))},t.reset=function(){for(var n in t.postMessage({reset:!0}),m)m[n](),delete m[n]}}(d)}return d}),y={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1};function b(t,n,e){return function(t,n){return n?n(t):t}(t&&null!=t[n]?t[n]:y[n],e)}function w(t){return parseInt(t,16)}function x(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function T(t){var n=t.getBoundingClientRect();t.width=n.width,t.height=n.height}function M(t,n,e,r,s){var c,f,u=n.slice(),l=t.getContext("2d"),h=a((function(n){function a(){c=f=null,l.clearRect(0,0,r.width,r.height),s(),n()}c=g.frame((function n(){!i||r.width===o.width&&r.height===o.height||(r.width=t.width=o.width,r.height=t.height=o.height),r.width||r.height||(e(t),r.width=t.width,r.height=t.height),l.clearRect(0,0,r.width,r.height),(u=u.filter((function(t){return function(t,n){n.x+=Math.cos(n.angle2D)*n.velocity,n.y+=Math.sin(n.angle2D)*n.velocity+n.gravity,n.wobble+=.1,n.velocity*=n.decay,n.tiltAngle+=.1,n.tiltSin=Math.sin(n.tiltAngle),n.tiltCos=Math.cos(n.tiltAngle),n.random=Math.random()+5,n.wobbleX=n.x+10*Math.cos(n.wobble),n.wobbleY=n.y+10*Math.sin(n.wobble);var e=n.tick++/n.totalTicks,i=n.x+n.random*n.tiltCos,o=n.y+n.random*n.tiltSin,r=n.wobbleX+n.random*n.tiltCos,s=n.wobbleY+n.random*n.tiltSin;return t.fillStyle="rgba("+n.color.r+", "+n.color.g+", "+n.color.b+", "+(1-e)+")",t.beginPath(),"circle"===n.shape?t.ellipse?t.ellipse(n.x,n.y,Math.abs(r-i)*n.ovalScalar,Math.abs(s-o)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI):function(t,n,e,i,o,r,s,a,c){t.save(),t.translate(n,e),t.rotate(r),t.scale(i,o),t.arc(0,0,1,s,a,c),t.restore()}(t,n.x,n.y,Math.abs(r-i)*n.ovalScalar,Math.abs(s-o)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI):(t.moveTo(Math.floor(n.x),Math.floor(n.y)),t.lineTo(Math.floor(n.wobbleX),Math.floor(o)),t.lineTo(Math.floor(r),Math.floor(s)),t.lineTo(Math.floor(i),Math.floor(n.wobbleY))),t.closePath(),t.fill(),n.tick<n.totalTicks}(l,t)}))).length?c=g.frame(n):a()})),f=a}));return{addFettis:function(t){return u=u.concat(t),h},canvas:t,promise:h,reset:function(){c&&g.cancel(c),f&&f()}}}function E(t,e){var i,o=!t,s=!!b(e||{},"resize"),c=b(e,"disableForReducedMotion",Boolean),f=r&&!!b(e||{},"useWorker")?v():null,u=o?x:T,l=!(!t||!f)&&!!t.__confetti_initialized,h="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function d(n,e,o){for(var r,s,a,c,f,l,h,d=b(n,"particleCount",Math.floor),p=b(n,"angle",Number),m=b(n,"spread",Number),g=b(n,"startVelocity",Number),v=b(n,"decay",Number),y=b(n,"gravity",Number),x=b(n,"colors"),T=b(n,"ticks",Number),E=b(n,"shapes"),S=function(t){var n=b(t,"origin",Object);return n.x=b(n,"x",Number),n.y=b(n,"y",Number),n}(n),P=d,k=[],_=t.width*S.x,L=t.height*S.y;P--;)k.push((r={x:_,y:L,angle:p,spread:m,startVelocity:g,color:x[P%x.length],shape:E[(l=0,h=E.length,Math.floor(Math.random()*(h-l))+l)],ticks:T,decay:v,gravity:y},s=void 0,a=void 0,c=void 0,f=void 0,c=r.angle*(Math.PI/180),f=r.spread*(Math.PI/180),{x:r.x,y:r.y,wobble:10*Math.random(),velocity:.5*r.startVelocity+Math.random()*r.startVelocity,angle2D:-c+(.5*f-Math.random()*f),tiltAngle:Math.random()*Math.PI,color:(s=r.color,a=String(s).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),{r:w(a.substring(0,2)),g:w(a.substring(2,4)),b:w(a.substring(4,6))}),shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,random:Math.random()+5,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*r.gravity,ovalScalar:.6}));return i?i.addFettis(k):(i=M(t,k,u,e,o)).promise}function p(e){var r=c||b(e,"disableForReducedMotion",Boolean),p=b(e,"zIndex",Number);if(r&&h)return a((function(t){t()}));o&&i?t=i.canvas:o&&!t&&(t=function(t){var n=document.createElement("canvas");return n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.pointerEvents="none",n.style.zIndex=t,n}(p),document.body.appendChild(t)),s&&!l&&u(t);var m={width:t.width,height:t.height};function g(){if(f){var n={getBoundingClientRect:function(){if(!o)return t.getBoundingClientRect()}};return u(n),void f.postMessage({resize:{width:n.width,height:n.height}})}m.width=m.height=null}function v(){i=null,s&&n.removeEventListener("resize",g),o&&t&&(document.body.removeChild(t),t=null,l=!1)}return f&&!l&&f.init(t),l=!0,f&&(t.__confetti_initialized=!0),s&&n.addEventListener("resize",g,!1),f?f.fire(e,m,v):d(e,m,v)}return p.reset=function(){f&&f.reset(),i&&i.reset()},p}e.exports=E(null,{useWorker:!0,resize:!0}),e.exports.create=E}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}(),i,!1);var o=i.exports;i.exports.create;o.Promise=Promise;const r=t=>{const n=document.querySelector(t);return new Promise(t=>{n.addEventListener("ended",()=>{t()}),n.play()})},s=(t,{width:n,height:e})=>new Promise(i=>{t.addEventListener("transitionend",()=>{i()},{once:!0}),t.style.width=n,t.style.height=e});var a=e(0),c=e.n(a);const f=Array.from(Array(9).keys()).reduce((t,n,e)=>({...t,["onEnterサイズ"+(e+1).toString()]:async()=>{console.log("onEnterサイズ"+(e+1).toString()+","+(100+50*(e+1)).toString()+"px, "+(300+10*(e+1)).toString()+"px");const t=document.querySelector("#風船");await Promise.all([r("#効果音：ビヨーン"),s(t,{width:(100+50*(e+1)).toString()+"px",height:(300+10*(e+1)).toString()+"px"})])}}),{}),u=c()({init:"開始",transitions:[{name:"ユーザー入力",from:"開始",to:"サイズ1"},{name:"ユーザー入力",from:"サイズ1",to:"サイズ2"},{name:"ユーザー入力",from:"サイズ2",to:"サイズ3"},{name:"ユーザー入力",from:"サイズ3",to:"サイズ4"},{name:"ユーザー入力",from:"サイズ4",to:"サイズ5"},{name:"ユーザー入力",from:"サイズ5",to:"サイズ6"},{name:"ユーザー入力",from:"サイズ6",to:"サイズ7"},{name:"ユーザー入力",from:"サイズ7",to:"サイズ8"},{name:"ユーザー入力",from:"サイズ8",to:"サイズ9"},{name:"ユーザー入力",from:"サイズ9",to:"バン！"},{name:"ユーザー入力",from:"バン！",to:"サイズ1"}],methods:{"onEnter開始":()=>{console.log("開始"),document.querySelector("#風船").style.opacity=1},...f,"onEnterバン！":async()=>{const t=document.querySelector("#紙吹雪用キャンバス"),n=document.querySelector("#風船");var e,i,a;await Promise.all([r("#効果音：ビヨーン"),s(n,{width:"600px",height:"400px"})]),await Promise.all([(a=n,new Promise(t=>{a.addEventListener("transitionend",()=>{t()},{once:!0}),a.style.opacity=0})),r("#効果音：バン！"),(e=t,i="#ff0000",o.create(e,{resize:!0,useWorker:!0})({particleCount:300,startVelocity:30,spread:360,origin:{y:.5,x:.5},...i&&{colors:[i]}})),s(n,{width:"100px",height:"300px"})]),await(t=>new Promise(n=>{t.addEventListener("transitionend",()=>{n()},{once:!0}),t.style.opacity=1}))(n)},onPendingTransition:()=>{console.log("まだ前の動作が終わっていません")}}});var l;l=async()=>{u.ユーザー入力()},document.body.addEventListener("click",()=>{l()})}]);