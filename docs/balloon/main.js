!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){var i;i=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";t.exports=function(t,e){var n,i,o;for(n=1;n<arguments.length;n++)for(o in i=arguments[n])i.hasOwnProperty(o)&&(t[o]=i[o]);return t}},function(t,e,n){"use strict";var i=n(0);t.exports={build:function(t,e){var n,o,r,s=e.plugins;for(n=0,o=s.length;n<o;n++)(r=s[n]).methods&&i(t,r.methods),r.properties&&Object.defineProperties(t,r.properties)},hook:function(t,e,n){var i,o,r,s,a=t.config.plugins,c=[t.context];for(n&&(c=c.concat(n)),i=0,o=a.length;i<o;i++)s=a[i],(r=a[i][e])&&r.apply(s,c)}}},function(t,e,n){"use strict";function i(t){if(0===t.length)return t;var e,n,i=t.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return t;for(n=i[0].toLowerCase(),e=1;e<i.length;e++)n=n+i[e].charAt(0).toUpperCase()+i[e].substring(1).toLowerCase();return n}i.prepended=function(t,e){return t+(e=i(e))[0].toUpperCase()+e.substring(1)},t.exports=i},function(t,e,n){"use strict";var i=n(0),o=n(2);function r(t,e){t=t||{},this.options=t,this.defaults=e.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(t.init),this.data=this.configureData(t.data),this.methods=this.configureMethods(t.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(t.transitions||[]),this.plugins=this.configurePlugins(t.plugins,e.plugin)}i(r.prototype,{addState:function(t){this.map[t]||(this.states.push(t),this.addStateLifecycleNames(t),this.map[t]={})},addStateLifecycleNames:function(t){this.lifecycle.onEnter[t]=o.prepended("onEnter",t),this.lifecycle.onLeave[t]=o.prepended("onLeave",t),this.lifecycle.on[t]=o.prepended("on",t)},addTransition:function(t){this.transitions.indexOf(t)<0&&(this.transitions.push(t),this.addTransitionLifecycleNames(t))},addTransitionLifecycleNames:function(t){this.lifecycle.onBefore[t]=o.prepended("onBefore",t),this.lifecycle.onAfter[t]=o.prepended("onAfter",t),this.lifecycle.on[t]=o.prepended("on",t)},mapTransition:function(t){var e=t.name,n=t.from,i=t.to;return this.addState(n),"function"!=typeof i&&this.addState(i),this.addTransition(e),this.map[n][e]=t,t},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(t){return"string"==typeof t?this.mapTransition(i({},this.defaults.init,{to:t,active:!0})):"object"==typeof t?this.mapTransition(i({},this.defaults.init,t,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(t){return"function"==typeof t?t:"object"==typeof t?function(){return t}:function(){return{}}},configureMethods:function(t){return t||{}},configurePlugins:function(t,e){var n,i,o;for(n=0,i=(t=t||[]).length;n<i;n++)"function"==typeof(o=t[n])&&(t[n]=o=o()),o.configure&&o.configure(this);return t},configureTransitions:function(t){var e,n,i,o,r,s=this.defaults.wildcard;for(n=0;n<t.length;n++)for(i=t[n],o=Array.isArray(i.from)?i.from:[i.from||s],r=i.to||s,e=0;e<o.length;e++)this.mapTransition({name:i.name,from:o[e],to:r})},transitionFor:function(t,e){var n=this.defaults.wildcard;return this.map[t][e]||this.map[n][e]},transitionsFor:function(t){var e=this.defaults.wildcard;return Object.keys(this.map[t]).concat(Object.keys(this.map[e]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),t.exports=r},function(t,e,n){var i=n(0),o=n(6),r=n(1),s=[null,[]];function a(t,e){this.context=t,this.config=e,this.state=e.init.from,this.observers=[t]}i(a.prototype,{init:function(t){if(i(this.context,this.config.data.apply(this.context,t)),r.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(t){return Array.isArray(t)?t.indexOf(this.state)>=0:this.state===t},isPending:function(){return this.pending},can:function(t){return!this.isPending()&&!!this.seek(t)},cannot:function(t){return!this.can(t)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(t,e){var n=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,t),o=i&&i.to;return"function"==typeof o?o.apply(this.context,e):o===n?this.state:o},fire:function(t,e){return this.transit(t,this.state,this.seek(t,e),e)},transit:function(t,e,n,i){var o=this.config.lifecycle,r=this.config.options.observeUnchangedState||e!==n;return n?this.isPending()?this.context.onPendingTransition(t,e,n):(this.config.addState(n),this.beginTransit(),i.unshift({transition:t,from:e,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(o.onBefore.transition),this.observersForEvent(o.onBefore[t]),r?this.observersForEvent(o.onLeave.state):s,r?this.observersForEvent(o.onLeave[e]):s,this.observersForEvent(o.on.transition),r?["doTransit",[this]]:s,r?this.observersForEvent(o.onEnter.state):s,r?this.observersForEvent(o.onEnter[n]):s,r?this.observersForEvent(o.on[n]):s,this.observersForEvent(o.onAfter.transition),this.observersForEvent(o.onAfter[t]),this.observersForEvent(o.on[t])],i)):this.context.onInvalidTransition(t,e,n)},beginTransit:function(){this.pending=!0},endTransit:function(t){return this.pending=!1,t},failTransit:function(t){throw this.pending=!1,t},doTransit:function(t){this.state=t.to},observe:function(t){if(2===t.length){var e={};e[t[0]]=t[1],this.observers.push(e)}else this.observers.push(t[0])},observersForEvent:function(t){for(var e,n=0,i=this.observers.length,o=[];n<i;n++)(e=this.observers[n])[t]&&o.push(e);return[t,o,!0]},observeEvents:function(t,e,n,i){if(0===t.length)return this.endTransit(void 0===i||i);var o=t[0][0],s=t[0][1],a=t[0][2];if(e[0].event=o,o&&a&&o!==n&&r.hook(this,"lifecycle",e),0===s.length)return t.shift(),this.observeEvents(t,e,o,i);var c=s.shift(),f=c[o].apply(c,e);return f&&"function"==typeof f.then?f.then(this.observeEvents.bind(this,t,e,o)).catch(this.failTransit.bind(this)):!1===f?this.endTransit(!1):this.observeEvents(t,e,o,f)},onInvalidTransition:function(t,e,n){throw new o("transition is invalid in current state",t,e,n,this.state)},onPendingTransition:function(t,e,n){throw new o("transition is invalid while previous transition is still in progress",t,e,n,this.state)}}),t.exports=a},function(t,e,n){"use strict";var i=n(0),o=n(2),r=n(1),s=n(3),a=n(4),c={is:function(t){return this._fsm.is(t)},can:function(t){return this._fsm.can(t)},cannot:function(t){return this._fsm.cannot(t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(t,e,n){return this._fsm.onInvalidTransition(t,e,n)},onPendingTransition:function(t,e,n){return this._fsm.onPendingTransition(t,e,n)}},f={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(t){throw Error("use transitions to change state")}}};function u(t){return l(this||{},t)}function l(t,e){return h(t,new s(e,u)),t._fsm(),t}function h(t,e){if("object"!=typeof t||Array.isArray(t))throw Error("StateMachine can only be applied to objects");r.build(t,e),Object.defineProperties(t,f),i(t,c),i(t,e.methods),e.allTransitions().forEach((function(e){t[o(e)]=function(){return this._fsm.fire(e,[].slice.call(arguments))}})),t._fsm=function(){this._fsm=new a(this,e),this._fsm.init(arguments)}}u.version="3.0.1",u.factory=function(){var t,e;"function"==typeof arguments[0]?(t=arguments[0],e=arguments[1]||{}):(t=function(){this._fsm.apply(this,arguments)},e=arguments[0]||{});var n=new s(e,u);return h(t.prototype,n),t.prototype._fsm.config=n,t},u.apply=l,u.defaults={wildcard:"*",init:{name:"init",from:"none"}},t.exports=u},function(t,e,n){"use strict";t.exports=function(t,e,n,i,o){this.message=t,this.transition=e,this.from=n,this.to=i,this.current=o}}])},t.exports=i()},function(t,e,n){"use strict";n.r(e);var i={};!function t(e,n,i,o){var r=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL);function s(){}function a(t){var i=n.exports.Promise,o=void 0!==i?i:e.Promise;return"function"==typeof o?new o(t):(t(s,s),null)}var c,f,u,l,h,d,p,m,g=(u=Math.floor(1e3/60),l={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(c=function(t){var e=Math.random();return l[e]=requestAnimationFrame((function n(i){h===i||h+u-1<i?(h=i,delete l[e],t()):l[e]=requestAnimationFrame(n)})),e},f=function(t){l[t]&&cancelAnimationFrame(l[t])}):(c=function(t){return setTimeout(t,u)},f=function(t){return clearTimeout(t)}),{frame:c,cancel:f}),v=(m={},function(){if(d)return d;if(!i&&r){var e=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{d=new Worker(URL.createObjectURL(new Blob([e])))}catch(t){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("🎊 Count not load worker",t),null}!function(t){function e(e,n){t.postMessage({options:e||{},callback:n})}t.init=function(e){var n=e.transferControlToOffscreen();t.postMessage({canvas:n},[n])},t.fire=function(n,i,o){if(p)return e(n,null),p;var r=Math.random().toString(36).slice(2);return p=a((function(i){function s(e){e.data.callback===r&&(delete m[r],t.removeEventListener("message",s),p=null,o(),i())}t.addEventListener("message",s),e(n,r),m[r]=s.bind(null,{data:{callback:r}})}))},t.reset=function(){for(var e in t.postMessage({reset:!0}),m)m[e](),delete m[e]}}(d)}return d}),y={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1};function b(t,e,n){return function(t,e){return e?e(t):t}(t&&null!=t[e]?t[e]:y[e],n)}function w(t){return parseInt(t,16)}function x(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function T(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function E(t,e,n,r,s){var c,f,u=e.slice(),l=t.getContext("2d"),h=a((function(e){function a(){c=f=null,l.clearRect(0,0,r.width,r.height),s(),e()}c=g.frame((function e(){!i||r.width===o.width&&r.height===o.height||(r.width=t.width=o.width,r.height=t.height=o.height),r.width||r.height||(n(t),r.width=t.width,r.height=t.height),l.clearRect(0,0,r.width,r.height),(u=u.filter((function(t){return function(t,e){e.x+=Math.cos(e.angle2D)*e.velocity,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.wobble+=.1,e.velocity*=e.decay,e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+5,e.wobbleX=e.x+10*Math.cos(e.wobble),e.wobbleY=e.y+10*Math.sin(e.wobble);var n=e.tick++/e.totalTicks,i=e.x+e.random*e.tiltCos,o=e.y+e.random*e.tiltSin,r=e.wobbleX+e.random*e.tiltCos,s=e.wobbleY+e.random*e.tiltSin;return t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-n)+")",t.beginPath(),"circle"===e.shape?t.ellipse?t.ellipse(e.x,e.y,Math.abs(r-i)*e.ovalScalar,Math.abs(s-o)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):function(t,e,n,i,o,r,s,a,c){t.save(),t.translate(e,n),t.rotate(r),t.scale(i,o),t.arc(0,0,1,s,a,c),t.restore()}(t,e.x,e.y,Math.abs(r-i)*e.ovalScalar,Math.abs(s-o)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):(t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(o)),t.lineTo(Math.floor(r),Math.floor(s)),t.lineTo(Math.floor(i),Math.floor(e.wobbleY))),t.closePath(),t.fill(),e.tick<e.totalTicks}(l,t)}))).length?c=g.frame(e):a()})),f=a}));return{addFettis:function(t){return u=u.concat(t),h},canvas:t,promise:h,reset:function(){c&&g.cancel(c),f&&f()}}}function M(t,n){var i,o=!t,s=!!b(n||{},"resize"),c=b(n,"disableForReducedMotion",Boolean),f=r&&!!b(n||{},"useWorker")?v():null,u=o?x:T,l=!(!t||!f)&&!!t.__confetti_initialized,h="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function d(e,n,o){for(var r,s,a,c,f,l,h,d=b(e,"particleCount",Math.floor),p=b(e,"angle",Number),m=b(e,"spread",Number),g=b(e,"startVelocity",Number),v=b(e,"decay",Number),y=b(e,"gravity",Number),x=b(e,"colors"),T=b(e,"ticks",Number),M=b(e,"shapes"),S=function(t){var e=b(t,"origin",Object);return e.x=b(e,"x",Number),e.y=b(e,"y",Number),e}(e),P=d,k=[],L=t.width*S.x,_=t.height*S.y;P--;)k.push((r={x:L,y:_,angle:p,spread:m,startVelocity:g,color:x[P%x.length],shape:M[(l=0,h=M.length,Math.floor(Math.random()*(h-l))+l)],ticks:T,decay:v,gravity:y},s=void 0,a=void 0,c=void 0,f=void 0,c=r.angle*(Math.PI/180),f=r.spread*(Math.PI/180),{x:r.x,y:r.y,wobble:10*Math.random(),velocity:.5*r.startVelocity+Math.random()*r.startVelocity,angle2D:-c+(.5*f-Math.random()*f),tiltAngle:Math.random()*Math.PI,color:(s=r.color,a=String(s).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),{r:w(a.substring(0,2)),g:w(a.substring(2,4)),b:w(a.substring(4,6))}),shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,random:Math.random()+5,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*r.gravity,ovalScalar:.6}));return i?i.addFettis(k):(i=E(t,k,u,n,o)).promise}function p(n){var r=c||b(n,"disableForReducedMotion",Boolean),p=b(n,"zIndex",Number);if(r&&h)return a((function(t){t()}));o&&i?t=i.canvas:o&&!t&&(t=function(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}(p),document.body.appendChild(t)),s&&!l&&u(t);var m={width:t.width,height:t.height};function g(){if(f){var e={getBoundingClientRect:function(){if(!o)return t.getBoundingClientRect()}};return u(e),void f.postMessage({resize:{width:e.width,height:e.height}})}m.width=m.height=null}function v(){i=null,s&&e.removeEventListener("resize",g),o&&t&&(document.body.removeChild(t),t=null,l=!1)}return f&&!l&&f.init(t),l=!0,f&&(t.__confetti_initialized=!0),s&&e.addEventListener("resize",g,!1),f?f.fire(n,m,v):d(n,m,v)}return p.reset=function(){f&&f.reset(),i&&i.reset()},p}n.exports=M(null,{useWorker:!0,resize:!0}),n.exports.create=M}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}(),i,!1);var o=i.exports;i.exports.create;o.Promise=Promise;const r=(t,e)=>{document.body.addEventListener("click",()=>{t()},e),document.addEventListener("keypress",()=>{t()},e)},s=t=>{const e=document.querySelector(t);return new Promise(t=>{e.addEventListener("ended",()=>{t()}),e.play()})},a=(t,{width:e,height:n})=>new Promise(i=>{t.addEventListener("transitionend",()=>{i()},{once:!0}),t.style.width=e,t.style.height=n});var c=n(0),f=n.n(c);const u=Array.from(Array(9).keys()).reduce((t,e,n)=>({...t,["onEnterサイズ"+(n+1).toString()]:async()=>{console.log("onEnterサイズ"+(n+1).toString()+","+(100+50*(n+1)).toString()+"px, "+(300+10*(n+1)).toString()+"px");const t=document.querySelector("#風船");await Promise.all([s("#効果音：ビヨーン"),a(t,{width:(100+50*(n+1)).toString()+"px",height:(300+10*(n+1)).toString()+"px"})])}}),{}),l=f()({init:"開始",transitions:[{name:"ユーザー入力",from:"開始",to:"サイズ1"},{name:"ユーザー入力",from:"サイズ1",to:"サイズ2"},{name:"ユーザー入力",from:"サイズ2",to:"サイズ3"},{name:"ユーザー入力",from:"サイズ3",to:"サイズ4"},{name:"ユーザー入力",from:"サイズ4",to:"サイズ5"},{name:"ユーザー入力",from:"サイズ5",to:"サイズ6"},{name:"ユーザー入力",from:"サイズ6",to:"サイズ7"},{name:"ユーザー入力",from:"サイズ7",to:"サイズ8"},{name:"ユーザー入力",from:"サイズ8",to:"サイズ9"},{name:"ユーザー入力",from:"サイズ9",to:"バン！"},{name:"ユーザー入力",from:"バン！",to:"サイズ1"}],methods:{"onEnter開始":()=>{},...u,"onEnterバン！":async()=>{const t=document.querySelector("#紙吹雪用キャンバス"),e=document.querySelector("#風船");var n,i,r;await Promise.all([s("#効果音：ビヨーン"),a(e,{width:"600px",height:"400px"})]),await Promise.all([(r=e,new Promise(t=>{r.addEventListener("transitionend",()=>{t()},{once:!0}),r.style.opacity=0})),s("#効果音：バン！"),(n=t,i="#ff0000",o.create(n,{resize:!0,useWorker:!0})({particleCount:300,startVelocity:30,spread:360,origin:{y:.5,x:.5},...i&&{colors:[i]}})),a(e,{width:"100px",height:"300px"})]),await(t=>new Promise(e=>{t.addEventListener("transitionend",()=>{e()},{once:!0}),t.style.opacity=1}))(e)},onPendingTransition:()=>{console.log("まだ前の動作が終わっていません")}}}),h=async()=>{l.ユーザー入力()};r(()=>{const t=document.querySelector("#効果音：ビヨーン");t.addEventListener("ended",()=>{r(h)}),t.play()})}]);